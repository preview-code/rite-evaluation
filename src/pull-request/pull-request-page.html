<link rel="import" href="../../bower_components/Sortable/Sortable.html">
<link rel="import" href="pull-request-comment.html">
<link rel="import" href="pull-request-chunk.html">

<dom-module id="pull-request-page">
  <template>
    <style>
      :host {
        display: flex;
        width: 100%;
      }
      :host > div {
        flex: 1;
      }
      .overview {
        max-width: 500px;
        border-right: black 1px solid;
      }
      .description {
        display: block;
        border-bottom: black 1px solid;
      }
    </style>
    <div class="overview">
      <h1>[[pr.title]]</h1>
      <span class="description">[[pr.description]]</span>
      <div class="comments">
        <template is="dom-repeat" items="[[pr.comments]]">
          <pull-request-comment comment="[[item]]"></pull-request-comment>
        </template>
      </div>
    </div>
    <div class="diff">
      <template is="dom-repeat" items="[[pr.chunks]]" as="chunk">
        <pull-request-chunk class="draggable" chunk="[[chunk]]"></pull-request-chunk>
      </template>
    </div>
  </template>
  <script>
    Polymer({
      is: 'pull-request-page',
      properties: {
        owner: String,
        name: String,
        prid: Number,
        pr: {
          type: Object,
          computed: '_getPR(prid)'
        }
      },

      _getPR: function() {
        return {
          cistatus: 'failed',
          title: 'My best PR',
          id: 25,
          owner: 'Tim van der Lippe',
          status: 'Under review',
          timeopened: 12341234,
          description: 'This is my very best PR. It fixes everything!',
          reviewers: [
            {
              name: 'Thomas Smith',
              lgtm: true,
              profile: 'https://avatars0.githubusercontent.com/u/5946422?v=3&s=72'
            },
            {
              name: 'Eva Anker',
              lgtm: false,
              profile: 'https://avatars1.githubusercontent.com/u/5946438?v=3&s=72'
            }
          ],
          comments: [
            {
              poster: 'Tim van der Lippe',
              timeopened: 12341234,
              text: 'Heeroy'
            },
            {
              poster: 'Eva Anker',
              timeopened: 1345,
              text: 'Hooi'
            }
          ],
          chunks: [
            {
              diff: [
                'bla',
                'bla2'
              ]
            },
            {
              diff: [
                'bla3',
                'bla4'
              ]
            }
          ]
        };
      }
    });
  </script>
</dom-module>
