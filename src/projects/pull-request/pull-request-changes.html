<link rel="import" href="../../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../diff/diff.html">
<link rel="import" href="space/pull-request-space.html">

<dom-module id="pull-request-changes">
  <template>
    <style>
      :host {
        display: block;
      }
      [hidden] {
        display: none !important;
      }
      .container {
        display: flex;
      }
      pull-request-space, pull-request-diff {
        flex: 1;
      }
    </style>
    <header>
      <paper-button raised on-tap="_showView" hidden$="[[showSpace]]">Show 2D view</paper-button>
      <paper-button raised on-tap="_hideView" hidden$="[[!showSpace]]">Hide 2D view</paper-button>
    </header>
    <div class="container">
      <pull-request-space data-route="space" groups="[[orderedGroups]]" hidden$="[[!showSpace]]"></pull-request-space>
      <pull-request-diff id="diff" data-route="diff" diff="[[diff]]"
          ordering="[[ordering]]" ordered-groups="{{orderedGroups}}"
          base-url="[[baseUrl]]" sha="[[sha]]"></pull-request-diff>
    </div>
  </template>
  <script>
    Polymer({
      is: 'pull-request-changes',
      properties: {
        diff: String,
        ordering: Array,
        baseUrl: String,
        sha: String,
        orderedGroups: Array,
        showSpace: {
          type: Boolean,
          value: false,
          notify: true
        }
      },
      observers: [
        '_hideView(baseUrl)'
      ],
      listeners: {
        'jump-to-group': 'jumpToGroup'
      },
      _showView: function() {
        this.showSpace = true;
        this.fire('force-hide-list');
      },
      _hideView: function() {
        this.showSpace = false;
      },
      jumpToGroup: function(e) {
        this.$.diff.jumpToGroup(e.detail.name);
      }
    });
  </script>
</dom-module>
